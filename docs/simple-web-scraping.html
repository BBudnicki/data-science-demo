<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Simple web scraping | Hayman Fire</title>
  <meta name="description" content="This is the final data science project for the Introduction to Data Science Course ESS 580A7." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Simple web scraping | Hayman Fire" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the final data science project for the Introduction to Data Science Course ESS 580A7." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Simple web scraping | Hayman Fire" />
  
  <meta name="twitter:description" content="This is the final data science project for the Introduction to Data Science Course ESS 580A7." />
  

<meta name="author" content="Brandon B" />


<meta name="date" content="2022-03-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hayman-fire.html"/>
<link rel="next" href="lagos-spatial-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.0/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.0/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="libs/lfx-sidebyside-1.0.0/lfx-side-by-side.js"></script>
<script src="libs/lfx-sidebyside-1.0.0/lfx-side-by-side-bindings.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="2" data-path="poudre-river.html"><a href="poudre-river.html"><i class="fa fa-check"></i><b>2</b> Poudre River<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="poudre-river.html"><a href="poudre-river.html#methods"><i class="fa fa-check"></i><b>2.1</b> Methods<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="poudre-river.html"><a href="poudre-river.html#sitedescription"><i class="fa fa-check"></i><b>2.2</b> SiteDescription<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="poudre-river.html"><a href="poudre-river.html#data-acquisition-and-plotting"><i class="fa fa-check"></i><b>2.3</b> Data Acquisition and Plotting<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="poudre-river.html"><a href="poudre-river.html#data-download"><i class="fa fa-check"></i><b>2.3.1</b> Data Download<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="poudre-river.html"><a href="poudre-river.html#static-data-plotter"><i class="fa fa-check"></i><b>2.3.2</b> Static Data Plotter<span></span></a></li>
<li class="chapter" data-level="2.3.3" data-path="poudre-river.html"><a href="poudre-river.html#interactive-data-plotter"><i class="fa fa-check"></i><b>2.3.3</b> Interactive Data Plotter<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="poudre-river.html"><a href="poudre-river.html#assignment."><i class="fa fa-check"></i><b>2.4</b> Assignment.<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="poudre-river.html"><a href="poudre-river.html#dygraph-example."><i class="fa fa-check"></i><b>2.5</b> DyGraph example.<span></span></a></li>
<li class="chapter" data-level="2.6" data-path="poudre-river.html"><a href="poudre-river.html#poudre-paragraph"><i class="fa fa-check"></i><b>2.6</b> Poudre Paragraph<span></span></a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="poudre-river.html"><a href="poudre-river.html#cameron-peak-fire"><i class="fa fa-check"></i><b>2.6.1</b> Cameron Peak Fire<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hayman-fire.html"><a href="hayman-fire.html"><i class="fa fa-check"></i><b>3</b> Hayman Fire<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="hayman-fire.html"><a href="hayman-fire.html#check-out-github"><i class="fa fa-check"></i><b>3.1</b> <span>Check out Github</span><span></span></a></li>
<li class="chapter" data-level="3.2" data-path="hayman-fire.html"><a href="hayman-fire.html#ndvi-plot-over-time"><i class="fa fa-check"></i><b>3.2</b> NDVI Plot over Time<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="hayman-fire.html"><a href="hayman-fire.html#question-1"><i class="fa fa-check"></i><b>3.3</b> Question 1<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="hayman-fire.html"><a href="hayman-fire.html#answer"><i class="fa fa-check"></i><b>3.3.1</b> Answer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="hayman-fire.html"><a href="hayman-fire.html#question-2"><i class="fa fa-check"></i><b>3.4</b> Question 2<span></span></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="hayman-fire.html"><a href="hayman-fire.html#answer-1"><i class="fa fa-check"></i><b>3.4.1</b> Answer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="hayman-fire.html"><a href="hayman-fire.html#question-3"><i class="fa fa-check"></i><b>3.5</b> Question 3<span></span></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="hayman-fire.html"><a href="hayman-fire.html#answer-2"><i class="fa fa-check"></i><b>3.5.1</b> Answer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="hayman-fire.html"><a href="hayman-fire.html#question-4"><i class="fa fa-check"></i><b>3.6</b> Question 4<span></span></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="hayman-fire.html"><a href="hayman-fire.html#answer-3"><i class="fa fa-check"></i><b>3.6.1</b> Answer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="hayman-fire.html"><a href="hayman-fire.html#question-5"><i class="fa fa-check"></i><b>3.7</b> Question 5<span></span></a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="hayman-fire.html"><a href="hayman-fire.html#answer-4"><i class="fa fa-check"></i><b>3.7.1</b> Answer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="hayman-fire.html"><a href="hayman-fire.html#question-6-bonus-redo-all-problems-with-spread-and-gather-using-modern-tidyverse-syntax."><i class="fa fa-check"></i><b>3.8</b> Question 6 (Bonus): Redo all problems with <code>spread</code> and <code>gather</code> using modern tidyverse syntax.<span></span></a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="hayman-fire.html"><a href="hayman-fire.html#gather"><i class="fa fa-check"></i><b>3.8.1</b> Gather<span></span></a></li>
<li class="chapter" data-level="3.8.2" data-path="hayman-fire.html"><a href="hayman-fire.html#spread"><i class="fa fa-check"></i><b>3.8.2</b> Spread<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="hayman-fire.html"><a href="hayman-fire.html#question-7-bonus-use-climate-engine-to-pull-the-same-data-for-the-assignment-but-updated-with-20202021-data."><i class="fa fa-check"></i><b>3.9</b> Question 7 (Bonus): Use Climate Engine to pull the same data for the assignment, but updated with 2020/2021 data.<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html"><i class="fa fa-check"></i><b>4</b> Simple web scraping<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#reading-an-html"><i class="fa fa-check"></i><b>4.1</b> Reading an html<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#extract-csv-links-from-webpage"><i class="fa fa-check"></i><b>4.1.1</b> Extract CSV links from webpage<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#data-download-1"><i class="fa fa-check"></i><b>4.2</b> Data Download<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#download-data-in-a-for-loop"><i class="fa fa-check"></i><b>4.2.1</b> Download data in a for loop<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#download-data-in-a-map"><i class="fa fa-check"></i><b>4.2.2</b> Download data in a map<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#data-read-in"><i class="fa fa-check"></i><b>4.3</b> Data read-in<span></span></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#read-in-just-the-snow-data-as-a-loop"><i class="fa fa-check"></i><b>4.3.1</b> Read in just the snow data as a loop<span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#read-in-the-data-as-a-map-function"><i class="fa fa-check"></i><b>4.3.2</b> Read in the data as a map function<span></span></a></li>
<li class="chapter" data-level="4.3.3" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#plot-snow-data"><i class="fa fa-check"></i><b>4.3.3</b> Plot snow data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#assignment"><i class="fa fa-check"></i><b>4.4</b> Assignment:<span></span></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#extract-the-meteorological-data-urls."><i class="fa fa-check"></i><b>4.4.1</b> 1. Extract the meteorological data URLs.<span></span></a></li>
<li class="chapter" data-level="4.4.2" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#download-the-meteorological-data."><i class="fa fa-check"></i><b>4.4.2</b> 2. Download the meteorological data.<span></span></a></li>
<li class="chapter" data-level="4.4.3" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#read-data"><i class="fa fa-check"></i><b>4.4.3</b> 3. Read data<span></span></a></li>
<li class="chapter" data-level="4.4.4" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#use-the-map-function"><i class="fa fa-check"></i><b>4.4.4</b> 4. Use the <code>map</code> function<span></span></a></li>
<li class="chapter" data-level="4.4.5" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#line-plot"><i class="fa fa-check"></i><b>4.4.5</b> 5. Line Plot<span></span></a></li>
<li class="chapter" data-level="4.4.6" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#line-plot-2"><i class="fa fa-check"></i><b>4.4.6</b> 6. Line plot 2<span></span></a></li>
<li class="chapter" data-level="4.4.7" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#bonus-1"><i class="fa fa-check"></i><b>4.4.7</b> 7 Bonus #1<span></span></a></li>
<li class="chapter" data-level="4.4.8" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#bonus-2"><i class="fa fa-check"></i><b>4.4.8</b> 8. Bonus #2<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="simple-web-scraping.html"><a href="simple-web-scraping.html#to-git-hub"><i class="fa fa-check"></i><b>4.5</b> To Git Hub<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html"><i class="fa fa-check"></i><b>5</b> LAGOS Spatial Analysis<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#loading-in-data"><i class="fa fa-check"></i><b>5.1</b> Loading in data<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#first-download-and-then-specifically-grab-the-locus-or-site-lat-longs"><i class="fa fa-check"></i><b>5.1.1</b> First download and then specifically grab the locus (or site lat longs)<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#convert-to-spatial-data"><i class="fa fa-check"></i><b>5.1.2</b> Convert to spatial data<span></span></a></li>
<li class="chapter" data-level="5.1.3" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#subset-to-only-minnesota"><i class="fa fa-check"></i><b>5.1.3</b> Subset to only Minnesota<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#in-class-work"><i class="fa fa-check"></i><b>5.2</b> In-Class work<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#map-of-iowa-illinois"><i class="fa fa-check"></i><b>5.3</b> 1 Map of Iowa &amp; Illinois<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#subset-lagos-data"><i class="fa fa-check"></i><b>5.4</b> 2 Subset LAGOS data<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#what-is-the-distribution-of-lake-size-in-iowa-vs.-minnesota"><i class="fa fa-check"></i><b>5.5</b> 3 What is the distribution of lake size in Iowa vs. Minnesota?<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#lakes-in-iowa-illinois-by-lake-area"><i class="fa fa-check"></i><b>5.6</b> 4 Lakes in Iowa &amp; Illinois by lake area<span></span></a></li>
<li class="chapter" data-level="5.7" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#what-other-data-sources-might-we-use-to-understand-how-reservoirs-and-natural-lakes-vary-in-size-in-these-three-states"><i class="fa fa-check"></i><b>5.7</b> 5 What other data sources might we use to understand how reservoirs and natural lakes vary in size in these three states?<span></span></a></li>
<li class="chapter" data-level="5.8" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#links"><i class="fa fa-check"></i><b>5.8</b> Links<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html"><i class="fa fa-check"></i><b>6</b> LAGOS Water Quality Analysis<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#loading-in-data-1"><i class="fa fa-check"></i><b>6.1</b> Loading in data<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#first-download-and-then-specifically-grab-the-locus-or-site-lat-longs-1"><i class="fa fa-check"></i><b>6.1.1</b> First download and then specifically grab the locus (or site lat longs)<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#subset-columns-nutr-to-only-keep-key-info-that-we-want"><i class="fa fa-check"></i><b>6.1.2</b> Subset columns nutr to only keep key info that we want<span></span></a></li>
<li class="chapter" data-level="6.1.3" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#keep-sites-with-at-least-200-observations"><i class="fa fa-check"></i><b>6.1.3</b> Keep sites with at least 200 observations<span></span></a></li>
<li class="chapter" data-level="6.1.4" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#join-water-quality-data-to-spatial-data"><i class="fa fa-check"></i><b>6.1.4</b> Join water quality data to spatial data<span></span></a></li>
<li class="chapter" data-level="6.1.5" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#mean-chl_a-map"><i class="fa fa-check"></i><b>6.1.5</b> Mean Chl_a map<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#class-work"><i class="fa fa-check"></i><b>6.2</b> Class work<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#what-is-the-correlation-between-secchi-disk-depth-and-chlorophyll-a-for-sites-with-at-least-200-observations"><i class="fa fa-check"></i><b>6.2.1</b> 1) What is the correlation between Secchi Disk Depth and Chlorophyll a for sites with at least 200 observations?<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#what-states-have-the-most-data"><i class="fa fa-check"></i><b>6.2.2</b> 2 What states have the most data?<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#is-there-a-spatial-pattern-in-secchi-disk-depth-for-lakes-with-at-least-200-observations"><i class="fa fa-check"></i><b>6.2.3</b> 3 Is there a <strong>spatial pattern</strong> in Secchi disk depth for lakes with at least 200 observations?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lagos-water-quality-analysis.html"><a href="lagos-water-quality-analysis.html#links-1"><i class="fa fa-check"></i><b>6.3</b> Links<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html"><i class="fa fa-check"></i><b>7</b> Weather and Corn Yield Regressions<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#setup"><i class="fa fa-check"></i><b>7.1</b> Setup<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#load-the-prism-daily-maximum-temperatures"><i class="fa fa-check"></i><b>7.1.1</b> Load the PRISM daily maximum temperatures<span></span></a></li>
<li class="chapter" data-level="7.1.2" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#temperature-trends"><i class="fa fa-check"></i><b>7.1.2</b> Temperature trends<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#assignment-1"><i class="fa fa-check"></i><b>7.2</b> Assignment<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-1-1"><i class="fa fa-check"></i><b>7.2.1</b> Question 1<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-2-time-series"><i class="fa fa-check"></i><b>7.2.2</b> Question 2 – Time Series<span></span></a></li>
<li class="chapter" data-level="7.2.3" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-3-cross-section"><i class="fa fa-check"></i><b>7.2.3</b> Question 3 – Cross-Section<span></span></a></li>
<li class="chapter" data-level="7.2.4" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-4-panel"><i class="fa fa-check"></i><b>7.2.4</b> Question 4 – Panel<span></span></a></li>
<li class="chapter" data-level="7.2.5" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-5-soybeans"><i class="fa fa-check"></i><b>7.2.5</b> Question 5 – Soybeans<span></span></a></li>
<li class="chapter" data-level="7.2.6" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-6-bonus"><i class="fa fa-check"></i><b>7.2.6</b> Question 6 Bonus<span></span></a></li>
<li class="chapter" data-level="7.2.7" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-7-bonus"><i class="fa fa-check"></i><b>7.2.7</b> Question 7 Bonus<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#links-2"><i class="fa fa-check"></i><b>7.3</b> Links<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hayman Fire</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-web-scraping" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Simple web scraping<a href="simple-web-scraping.html#simple-web-scraping" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>R can read html using either rvest, xml, or xml2 packages. Here we are going to navigate to the Center for Snow and Avalanche Studies <a href="https://snowstudies.org/archived-data/">Website</a> and read a table in. This table contains links to data we want to programmatically download for three sites. We don’t know much about these sites, but they contain incredibly rich snow, temperature, and precipitation data.</p>
<div id="reading-an-html" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Reading an html<a href="simple-web-scraping.html#reading-an-html" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="extract-csv-links-from-webpage" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Extract CSV links from webpage<a href="simple-web-scraping.html#extract-csv-links-from-webpage" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="simple-web-scraping.html#cb24-1" aria-hidden="true" tabindex="-1"></a>site_url <span class="ot">&lt;-</span> <span class="st">&#39;https://snowstudies.org/archived-data/&#39;</span></span>
<span id="cb24-2"><a href="simple-web-scraping.html#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="simple-web-scraping.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Read the web url</span></span>
<span id="cb24-4"><a href="simple-web-scraping.html#cb24-4" aria-hidden="true" tabindex="-1"></a>webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(site_url)</span>
<span id="cb24-5"><a href="simple-web-scraping.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#See if we can extract tables and get the data that way</span></span>
<span id="cb24-6"><a href="simple-web-scraping.html#cb24-6" aria-hidden="true" tabindex="-1"></a>tables <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="simple-web-scraping.html#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;table&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="simple-web-scraping.html#cb24-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="simple-web-scraping.html#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-10"><a href="simple-web-scraping.html#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">#That didn&#39;t work, so let&#39;s try a different approach</span></span>
<span id="cb24-11"><a href="simple-web-scraping.html#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="simple-web-scraping.html#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract only weblinks and then the URLs!</span></span>
<span id="cb24-13"><a href="simple-web-scraping.html#cb24-13" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb24-14"><a href="simple-web-scraping.html#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;a&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="simple-web-scraping.html#cb24-15" aria-hidden="true" tabindex="-1"></a>  .[<span class="fu">grepl</span>(<span class="st">&#39;24hr&#39;</span>,.)] <span class="sc">%&gt;%</span></span>
<span id="cb24-16"><a href="simple-web-scraping.html#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&#39;href&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="data-download-1" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Data Download<a href="simple-web-scraping.html#data-download-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="download-data-in-a-for-loop" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Download data in a for loop<a href="simple-web-scraping.html#download-data-in-a-for-loop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="simple-web-scraping.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grab only the name of the file by splitting out on forward slashes</span></span>
<span id="cb25-2"><a href="simple-web-scraping.html#cb25-2" aria-hidden="true" tabindex="-1"></a>splits <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(links,<span class="st">&#39;/&#39;</span>,<span class="dv">8</span>)</span>
<span id="cb25-3"><a href="simple-web-scraping.html#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="simple-web-scraping.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Keep only the 8th column</span></span>
<span id="cb25-5"><a href="simple-web-scraping.html#cb25-5" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> splits[,<span class="dv">8</span>] </span>
<span id="cb25-6"><a href="simple-web-scraping.html#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="simple-web-scraping.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a file list for where the data goes</span></span>
<span id="cb25-8"><a href="simple-web-scraping.html#cb25-8" aria-hidden="true" tabindex="-1"></a>datapath <span class="ot">=</span> <span class="st">&#39;data/snow/&#39;</span></span>
<span id="cb25-9"><a href="simple-web-scraping.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(datapath)</span></code></pre></div>
<pre><code>## Warning in dir.create(datapath): &#39;data\snow&#39; already exists</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="simple-web-scraping.html#cb27-1" aria-hidden="true" tabindex="-1"></a>file_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(datapath,dataset)</span>
<span id="cb27-2"><a href="simple-web-scraping.html#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="simple-web-scraping.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb27-4"><a href="simple-web-scraping.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(links[i],<span class="at">destfile=</span>file_names[i])</span>
<span id="cb27-5"><a href="simple-web-scraping.html#cb27-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-6"><a href="simple-web-scraping.html#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="simple-web-scraping.html#cb27-7" aria-hidden="true" tabindex="-1"></a>downloaded <span class="ot">&lt;-</span> <span class="fu">file.exists</span>(file_names)</span>
<span id="cb27-8"><a href="simple-web-scraping.html#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="simple-web-scraping.html#cb27-9" aria-hidden="true" tabindex="-1"></a>evaluate <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">all</span>(downloaded)</span></code></pre></div>
</div>
<div id="download-data-in-a-map" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Download data in a map<a href="simple-web-scraping.html#download-data-in-a-map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="simple-web-scraping.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Map version of the same for loop (downloading 3 files)</span></span>
<span id="cb28-2"><a href="simple-web-scraping.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(evaluate <span class="sc">==</span> T){</span>
<span id="cb28-3"><a href="simple-web-scraping.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map2</span>(links[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],file_names[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],download.file)</span>
<span id="cb28-4"><a href="simple-web-scraping.html#cb28-4" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{<span class="fu">print</span>(<span class="st">&#39;data already downloaded&#39;</span>)}</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0
## 
## [[2]]
## [1] 0
## 
## [[3]]
## [1] 0</code></pre>
</div>
</div>
<div id="data-read-in" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Data read-in<a href="simple-web-scraping.html#data-read-in" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="read-in-just-the-snow-data-as-a-loop" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Read in just the snow data as a loop<a href="simple-web-scraping.html#read-in-just-the-snow-data-as-a-loop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="simple-web-scraping.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pattern matching to only keep certain files</span></span>
<span id="cb30-2"><a href="simple-web-scraping.html#cb30-2" aria-hidden="true" tabindex="-1"></a>snow_files <span class="ot">&lt;-</span> file_names <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="simple-web-scraping.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  .[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&#39;SG_24&#39;</span>,.)] <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="simple-web-scraping.html#cb30-4" aria-hidden="true" tabindex="-1"></a>  .[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&#39;PTSP&#39;</span>,.)]</span>
<span id="cb30-5"><a href="simple-web-scraping.html#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="simple-web-scraping.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#empty_data &lt;- list()</span></span>
<span id="cb30-7"><a href="simple-web-scraping.html#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="simple-web-scraping.html#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># snow_data &lt;- for(i in 1:length(snow_files)){</span></span>
<span id="cb30-9"><a href="simple-web-scraping.html#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   empty_data[[i]] &lt;- read_csv(snow_files[i]) %&gt;%</span></span>
<span id="cb30-10"><a href="simple-web-scraping.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     select(Year,DOY,Sno_Height_M)</span></span>
<span id="cb30-11"><a href="simple-web-scraping.html#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb30-12"><a href="simple-web-scraping.html#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="simple-web-scraping.html#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">#snow_data_full &lt;- do.call(&#39;rbind&#39;,empty_data)</span></span>
<span id="cb30-14"><a href="simple-web-scraping.html#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="simple-web-scraping.html#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(snow_data_full)</span></span></code></pre></div>
</div>
<div id="read-in-the-data-as-a-map-function" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Read in the data as a map function<a href="simple-web-scraping.html#read-in-the-data-as-a-map-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="simple-web-scraping.html#cb31-1" aria-hidden="true" tabindex="-1"></a>our_snow_reader <span class="ot">&lt;-</span> <span class="cf">function</span>(file){</span>
<span id="cb31-2"><a href="simple-web-scraping.html#cb31-2" aria-hidden="true" tabindex="-1"></a>  name <span class="ot">=</span> <span class="fu">str_split_fixed</span>(file,<span class="st">&#39;/&#39;</span>,<span class="dv">2</span>)[,<span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="simple-web-scraping.html#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gsub</span>(<span class="st">&#39;_24hr.csv&#39;</span>,<span class="st">&#39;&#39;</span>,.)</span>
<span id="cb31-4"><a href="simple-web-scraping.html#cb31-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(file) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="simple-web-scraping.html#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Year,DOY,Sno_Height_M) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="simple-web-scraping.html#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">site =</span> name)</span>
<span id="cb31-7"><a href="simple-web-scraping.html#cb31-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-8"><a href="simple-web-scraping.html#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="simple-web-scraping.html#cb31-9" aria-hidden="true" tabindex="-1"></a>snow_data_full <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(snow_files,our_snow_reader)</span></code></pre></div>
<pre><code>## Rows: 6211 Columns: 52
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (52): ArrayID, Year, DOY, Hour, LoAir_Min_C, LoAir_Min_Time, LoAir_Max_C...
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
## Rows: 6575 Columns: 48
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (48): ArrayID, Year, DOY, Hour, LoAir_Min_C, LoAir_Min_Time, LoAir_Max_C...
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="simple-web-scraping.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(snow_data_full)</span></code></pre></div>
<pre><code>##       Year           DOY         Sno_Height_M        site          
##  Min.   :2003   Min.   :  1.0   Min.   :-3.523   Length:12786      
##  1st Qu.:2008   1st Qu.: 92.0   1st Qu.: 0.350   Class :character  
##  Median :2012   Median :183.0   Median : 0.978   Mode  :character  
##  Mean   :2012   Mean   :183.1   Mean   : 0.981                     
##  3rd Qu.:2016   3rd Qu.:274.0   3rd Qu.: 1.520                     
##  Max.   :2021   Max.   :366.0   Max.   : 2.905                     
##                                 NA&#39;s   :4554</code></pre>
</div>
<div id="plot-snow-data" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Plot snow data<a href="simple-web-scraping.html#plot-snow-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="simple-web-scraping.html#cb35-1" aria-hidden="true" tabindex="-1"></a>snow_yearly <span class="ot">&lt;-</span> snow_data_full <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="simple-web-scraping.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year,site) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="simple-web-scraping.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_height =</span> <span class="fu">mean</span>(Sno_Height_M,<span class="at">na.rm=</span>T))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Year&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="simple-web-scraping.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(snow_yearly,<span class="fu">aes</span>(<span class="at">x=</span>Year,<span class="at">y=</span>mean_height,<span class="at">color=</span>site)) <span class="sc">+</span> </span>
<span id="cb37-2"><a href="simple-web-scraping.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-3"><a href="simple-web-scraping.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span> </span>
<span id="cb37-4"><a href="simple-web-scraping.html#cb37-4" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_few</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
<div id="assignment" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Assignment:<a href="simple-web-scraping.html#assignment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="extract-the-meteorological-data-urls." class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> 1. Extract the meteorological data URLs.<a href="simple-web-scraping.html#extract-the-meteorological-data-urls." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we want you to use the <code>rvest</code> package to get the URLs for the <code>SASP forcing</code> and <code>SBSP_forcing</code> meteorological data sets.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="simple-web-scraping.html#cb39-1" aria-hidden="true" tabindex="-1"></a>q1_links <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="simple-web-scraping.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;a&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="simple-web-scraping.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  .[<span class="fu">grepl</span>(<span class="st">&#39;forcing&#39;</span>,.)] <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="simple-web-scraping.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&#39;href&#39;</span>)</span></code></pre></div>
</div>
<div id="download-the-meteorological-data." class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> 2. Download the meteorological data.<a href="simple-web-scraping.html#download-the-meteorological-data." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>download_file</code> and <code>str_split_fixed</code> commands to download the data and save it in your data folder. You can use a for loop or a map function.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="simple-web-scraping.html#cb40-1" aria-hidden="true" tabindex="-1"></a>q2_splits <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(q1_links,<span class="st">&#39;/&#39;</span>,<span class="dv">8</span>)</span>
<span id="cb40-2"><a href="simple-web-scraping.html#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="simple-web-scraping.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Keep only the 8th column</span></span>
<span id="cb40-4"><a href="simple-web-scraping.html#cb40-4" aria-hidden="true" tabindex="-1"></a>q2_dataset <span class="ot">&lt;-</span> q2_splits[,<span class="dv">8</span>] </span>
<span id="cb40-5"><a href="simple-web-scraping.html#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="simple-web-scraping.html#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="simple-web-scraping.html#cb40-7" aria-hidden="true" tabindex="-1"></a>q2_file_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(datapath,q2_dataset)</span>
<span id="cb40-8"><a href="simple-web-scraping.html#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="simple-web-scraping.html#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb40-10"><a href="simple-web-scraping.html#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(q1_links[i],<span class="at">destfile=</span>q2_file_names[i])</span>
<span id="cb40-11"><a href="simple-web-scraping.html#cb40-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-12"><a href="simple-web-scraping.html#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="simple-web-scraping.html#cb40-13" aria-hidden="true" tabindex="-1"></a>q2_downloaded <span class="ot">&lt;-</span> <span class="fu">file.exists</span>(file_names)</span>
<span id="cb40-14"><a href="simple-web-scraping.html#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="simple-web-scraping.html#cb40-15" aria-hidden="true" tabindex="-1"></a>evaluate <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">all</span>(q2_downloaded)</span></code></pre></div>
</div>
<div id="read-data" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> 3. Read data<a href="simple-web-scraping.html#read-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write a custom function to read in the data and append a site column to the data.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="simple-web-scraping.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this code grabs the variable names from the metadata pdf file</span></span>
<span id="cb41-2"><a href="simple-web-scraping.html#cb41-2" aria-hidden="true" tabindex="-1"></a>q3_headers <span class="ot">&lt;-</span> <span class="fu">pdf_text</span>(<span class="st">&#39;https://snowstudies.org/wp-content/uploads/2022/02/Serially-Complete-Metadata-text08.pdf&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="simple-web-scraping.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_lines</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="simple-web-scraping.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">trimws</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="simple-web-scraping.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_split_fixed</span>(.,<span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>,<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="simple-web-scraping.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  .[,<span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="simple-web-scraping.html#cb41-7" aria-hidden="true" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>] <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="simple-web-scraping.html#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_trim</span>(<span class="at">side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb41-9"><a href="simple-web-scraping.html#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="simple-web-scraping.html#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="simple-web-scraping.html#cb41-11" aria-hidden="true" tabindex="-1"></a>q3_reader <span class="ot">&lt;-</span> <span class="cf">function</span>(file){</span>
<span id="cb41-12"><a href="simple-web-scraping.html#cb41-12" aria-hidden="true" tabindex="-1"></a>  fileName <span class="ot">=</span> <span class="fu">str_split_fixed</span>(file,<span class="st">&#39;/&#39;</span>,<span class="dv">2</span>)[,<span class="dv">2</span>]</span>
<span id="cb41-13"><a href="simple-web-scraping.html#cb41-13" aria-hidden="true" tabindex="-1"></a>    nameRight <span class="ot">=</span>  <span class="fu">str_split_fixed</span>(fileName,<span class="st">&#39;_&#39;</span>,<span class="dv">2</span>)[,<span class="dv">2</span>] </span>
<span id="cb41-14"><a href="simple-web-scraping.html#cb41-14" aria-hidden="true" tabindex="-1"></a>    nameLeft <span class="ot">=</span>  <span class="fu">str_split_fixed</span>(nameRight,<span class="st">&#39;_&#39;</span>,<span class="dv">2</span>)[,<span class="dv">1</span>] </span>
<span id="cb41-15"><a href="simple-web-scraping.html#cb41-15" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(file, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span><span class="st">&quot;&quot;</span>,<span class="at">col.names =</span> q3_headers,<span class="at">skip =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-16"><a href="simple-web-scraping.html#cb41-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">site =</span> nameLeft) <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="simple-web-scraping.html#cb41-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">date =</span>  <span class="fu">as.Date</span>(<span class="fu">paste</span>(year, month, day, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb41-18"><a href="simple-web-scraping.html#cb41-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">air_temp_k =</span> air.temp..K.) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="simple-web-scraping.html#cb41-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">air_temp_c =</span> <span class="fu">kelvin.to.celsius</span>(air.temp..K.))</span>
<span id="cb41-20"><a href="simple-web-scraping.html#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="simple-web-scraping.html#cb41-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="use-the-map-function" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> 4. Use the <code>map</code> function<a href="simple-web-scraping.html#use-the-map-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Read in both meteorological files. Display a summary of your tibble.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="simple-web-scraping.html#cb42-1" aria-hidden="true" tabindex="-1"></a>q4_full <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(q2_file_names,q3_reader)</span>
<span id="cb42-2"><a href="simple-web-scraping.html#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="simple-web-scraping.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(q4_full)</span></code></pre></div>
<pre><code>##       year          month             day             hour           minute 
##  Min.   :2003   Min.   : 1.000   Min.   : 1.00   Min.   : 0.00   Min.   :0  
##  1st Qu.:2005   1st Qu.: 3.000   1st Qu.: 8.00   1st Qu.: 5.75   1st Qu.:0  
##  Median :2007   Median : 6.000   Median :16.00   Median :11.50   Median :0  
##  Mean   :2007   Mean   : 6.472   Mean   :15.76   Mean   :11.50   Mean   :0  
##  3rd Qu.:2009   3rd Qu.: 9.000   3rd Qu.:23.00   3rd Qu.:17.25   3rd Qu.:0  
##  Max.   :2011   Max.   :12.000   Max.   :31.00   Max.   :23.00   Max.   :0  
##                                                                             
##      second  precip..kg.m.2.s.1. sw.down..W.m.2.     lw.down..W.m.2.  
##  Min.   :0   Min.   :0.000e+00   Min.   :-9999.000   Min.   :-9999.0  
##  1st Qu.:0   1st Qu.:0.000e+00   1st Qu.:   -3.510   1st Qu.:  173.4  
##  Median :0   Median :0.000e+00   Median :   -0.344   Median :  231.4  
##  Mean   :0   Mean   :3.838e-05   Mean   :-1351.008   Mean   :-1325.7  
##  3rd Qu.:0   3rd Qu.:0.000e+00   3rd Qu.:  294.900   3rd Qu.:  272.2  
##  Max.   :0   Max.   :6.111e-03   Max.   : 1341.000   Max.   :  365.8  
##                                                                       
##   air.temp..K.   windspeed..m.s.1.   relative.humidity.... pressure..Pa.  
##  Min.   :242.1   Min.   :-9999.000   Min.   :  0.011       Min.   :63931  
##  1st Qu.:265.8   1st Qu.:    0.852   1st Qu.: 37.580       1st Qu.:63931  
##  Median :272.6   Median :    1.548   Median : 59.910       Median :65397  
##  Mean   :272.6   Mean   : -790.054   Mean   : 58.891       Mean   :65397  
##  3rd Qu.:279.7   3rd Qu.:    3.087   3rd Qu.: 81.600       3rd Qu.:66863  
##  Max.   :295.8   Max.   :  317.300   Max.   :324.800       Max.   :66863  
##                                                                           
##  specific.humidity..g.g.1. calculated.dewpoint.temperature..K.
##  Min.   :0.000000          Min.   :   0.0                     
##  1st Qu.:0.001744          1st Qu.:   0.0                     
##  Median :0.002838          Median :   0.0                     
##  Mean   :0.003372          Mean   :  74.9                     
##  3rd Qu.:0.004508          3rd Qu.:   0.0                     
##  Max.   :0.014780          Max.   :2002.0                     
##                                                               
##  precip..WMO.corrected..kg.m.2.s.1.
##  Min.   :   0.0                    
##  1st Qu.:   0.0                    
##  Median :   0.0                    
##  Mean   : 424.7                    
##  3rd Qu.:   0.0                    
##  Max.   :3002.0                    
##                                    
##  air.temp..corrected.with.Kent.et.al...1993...K.
##  Min.   :   0                                   
##  1st Qu.:   0                                   
##  Median :   0                                   
##  Mean   : 438                                   
##  3rd Qu.:   0                                   
##  Max.   :5002                                   
##                                                 
##  air.temp..corrected.with.Anderson.and.Baumgartner..1998..K.
##  Min.   :   0.0                                             
##  1st Qu.:   0.0                                             
##  Median :   0.0                                             
##  Mean   : 173.9                                             
##  3rd Qu.:   0.0                                             
##  Max.   :5002.0                                             
##                                                             
##  air.temp..corrected.with.Nakamura.and.Mahrt..2005...K.
##  Min.   :   0.0                                        
##  1st Qu.:   0.0                                        
##  Median :   0.0                                        
##  Mean   : 605.9                                        
##  3rd Qu.:   0.0                                        
##  Max.   :6002.0                                        
##                                                        
##  air.temp..corrected.with.Huwald.et.al...2009...K. qc.code.precip
##  Min.   :   0.00                                   Mode:logical  
##  1st Qu.:   0.00                                   NA&#39;s:138336   
##  Median :   0.00                                                 
##  Mean   :  56.49                                                 
##  3rd Qu.:   0.00                                                 
##  Max.   :6009.00                                                 
##  NA&#39;s   :5214                                                    
##  qc.code.sw.down qc.code.lw.down qc.code.air.temp qc.code.wind.speed
##  Mode:logical    Mode:logical    Mode:logical     Mode:logical      
##  NA&#39;s:138336     NA&#39;s:138336     NA&#39;s:138336      NA&#39;s:138336       
##                                                                     
##                                                                     
##                                                                     
##                                                                     
##                                                                     
##  qc.code.relhum     site                date              air_temp_k   
##  Mode:logical   Length:138336      Min.   :2003-11-10   Min.   :242.1  
##  NA&#39;s:138336    Class :character   1st Qu.:2005-10-30   1st Qu.:265.8  
##                 Mode  :character   Median :2007-10-21   Median :272.6  
##                                    Mean   :2007-10-20   Mean   :272.6  
##                                    3rd Qu.:2009-10-10   3rd Qu.:279.7  
##                                    Max.   :2011-10-01   Max.   :295.8  
##                                                                        
##    air_temp_c      
##  Min.   :-31.0400  
##  1st Qu.: -7.3700  
##  Median : -0.5600  
##  Mean   : -0.5745  
##  3rd Qu.:  6.5300  
##  Max.   : 22.6900  
## </code></pre>
</div>
<div id="line-plot" class="section level3 hasAnchor" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> 5. Line Plot<a href="simple-web-scraping.html#line-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Make a line plot of mean temp by year by site (using the <code>air temp [K]</code> variable). Is there anything suspicious in the plot? Adjust your filtering if needed.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="simple-web-scraping.html#cb44-1" aria-hidden="true" tabindex="-1"></a>q5_yearly <span class="ot">&lt;-</span> q4_full <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="simple-web-scraping.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,site) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="simple-web-scraping.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_temp_k =</span> <span class="fu">mean</span>(air_temp_k,<span class="at">na.rm=</span>T), <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(year, <span class="st">&quot;01&quot;</span>, <span class="st">&quot;01&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>)))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;site&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="simple-web-scraping.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q5_yearly) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="simple-web-scraping.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>mean_temp_k,<span class="at">color=</span>site)) <span class="sc">+</span> </span>
<span id="cb46-3"><a href="simple-web-scraping.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span> </span>
<span id="cb46-4"><a href="simple-web-scraping.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_few</span>() <span class="sc">+</span></span>
<span id="cb46-5"><a href="simple-web-scraping.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">&quot;Air Temperture (Kelvin)&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="simple-web-scraping.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fig 1: Mean Air Temperture by Year&quot;</span>)</span></code></pre></div>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Figure 1 shows the annual mean air temperature for both sites in a given year. 2003 &amp; 2004 have unusually low air temperatures.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="simple-web-scraping.html#cb47-1" aria-hidden="true" tabindex="-1"></a>q5_daily <span class="ot">&lt;-</span> q4_full <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="simple-web-scraping.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date,site)</span>
<span id="cb47-3"><a href="simple-web-scraping.html#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="simple-web-scraping.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q5_daily) <span class="sc">+</span></span>
<span id="cb47-5"><a href="simple-web-scraping.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="fu">factor</span>(year), <span class="at">y=</span>air_temp_k,<span class="at">na.rm=</span>T),</span>
<span id="cb47-6"><a href="simple-web-scraping.html#cb47-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb47-7"><a href="simple-web-scraping.html#cb47-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb47-8"><a href="simple-web-scraping.html#cb47-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">outlier.size=</span><span class="dv">2</span>, </span>
<span id="cb47-9"><a href="simple-web-scraping.html#cb47-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">notch=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb47-10"><a href="simple-web-scraping.html#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">&quot;Air Temperture (Kelvin)&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-11"><a href="simple-web-scraping.html#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fig 2: Boxplot Air Temperture by year&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Ignoring unknown aesthetics: na.rm</code></pre>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>In figure 2 we see the air temperature in 2004 was only slightly lower, with the interquartile range being roughly the same. On the other hand 2003 had a significantly narrower interquartile range. At the scale of 1 year it is difficult to tell how much the 2003 data is skewed by collecting part of the year, if it was unusually cold that year, or if there was an issue with the instrumentation.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="simple-web-scraping.html#cb49-1" aria-hidden="true" tabindex="-1"></a>q5_yearly <span class="ot">&lt;-</span> q4_full <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="simple-web-scraping.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,month,site) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="simple-web-scraping.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_temp_k =</span> <span class="fu">mean</span>(air_temp_k,<span class="at">na.rm=</span>T), <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(year, month, <span class="st">&quot;01&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>)))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;, &#39;site&#39;. You can override
## using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="simple-web-scraping.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q5_yearly) <span class="sc">+</span> </span>
<span id="cb51-2"><a href="simple-web-scraping.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>mean_temp_k,<span class="at">color=</span>site)) <span class="sc">+</span> </span>
<span id="cb51-3"><a href="simple-web-scraping.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span> </span>
<span id="cb51-4"><a href="simple-web-scraping.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_few</span>() <span class="sc">+</span></span>
<span id="cb51-5"><a href="simple-web-scraping.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">limit=</span><span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2003-11-01&quot;</span>),<span class="fu">as.Date</span>(<span class="st">&quot;2007-01-01&quot;</span>))) <span class="sc">+</span></span>
<span id="cb51-6"><a href="simple-web-scraping.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">&quot;Air Temperture (Kelvin)&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="simple-web-scraping.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fig 3: Mean air Temperture by Month&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;2003 - 2006&quot;</span> )</span></code></pre></div>
<pre><code>## Warning: Removed 81746 row(s) containing missing values (geom_path).</code></pre>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>In figure 3 we see that it was unusually cold at both sites for the 2003 &amp; 2004 data. Much more for the SBSP. Due to only collecting data for the end of the year, 2003 data has a lower mean temperature as it does not include the summer months. Looking at the header file <a href="https://snowstudies.org/wp-content/uploads/2022/02/Serially-Complete-Metadata-text08.pdf">Serially-Complete-Metadata-text08.pdf</a> we can see that they do include QC Code columns, but those values do not appear in the data set itself. The table of code values indicate some of the data has the followings errors, but the dates are not specified.</p>
<div id="air-temp-error-codes" class="section level5 hasAnchor" number="4.4.5.0.1">
<h5><span class="header-section-number">4.4.5.0.1</span> Air temp Error Codes<a href="simple-web-scraping.html#air-temp-error-codes" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ul>
<li>5001: missing data: use data from upper measurement location at same site (regression fill)</li>
<li>5003: missing data: use data from paired site (regression fill)</li>
<li>6000: before desired time period</li>
<li>6001: missing data: use data from upper measurement location at same site (regression fill)</li>
<li>6002: missing data: use data from paired site (regression fill)</li>
<li>6009: missing data: assume RH is 50%.</li>
</ul>
</div>
</div>
<div id="line-plot-2" class="section level3 hasAnchor" number="4.4.6">
<h3><span class="header-section-number">4.4.6</span> 6. Line plot 2<a href="simple-web-scraping.html#line-plot-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write a function that makes line plots of monthly average temperature at each site for a given year. Use a for loop to make these plots for 2005 to 2010. Are monthly average temperatures at the Senator Beck Study Plot ever warmer than the Snow Angel Study Plot?
Hint: <a href="https://ggplot2.tidyverse.org/reference/print.ggplot.html">https://ggplot2.tidyverse.org/reference/print.ggplot.html</a></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="simple-web-scraping.html#cb53-1" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2005</span>,<span class="dv">2010</span>)</span>
<span id="cb53-2"><a href="simple-web-scraping.html#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="simple-web-scraping.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (yearly <span class="cf">in</span> years) {</span>
<span id="cb53-4"><a href="simple-web-scraping.html#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="simple-web-scraping.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  thisYear <span class="ot">&lt;-</span> q4_full <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> yearly)  <span class="sc">%&gt;%</span></span>
<span id="cb53-6"><a href="simple-web-scraping.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month,site) <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="simple-web-scraping.html#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_temp_k =</span> <span class="fu">mean</span>(air_temp_k,<span class="at">na.rm=</span>T))</span>
<span id="cb53-8"><a href="simple-web-scraping.html#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="simple-web-scraping.html#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(</span>
<span id="cb53-10"><a href="simple-web-scraping.html#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(thisYear) <span class="sc">+</span></span>
<span id="cb53-11"><a href="simple-web-scraping.html#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>month,<span class="at">y=</span>mean_temp_k,<span class="at">color=</span>site,<span class="at">group=</span><span class="fu">factor</span>(site))) <span class="sc">+</span></span>
<span id="cb53-12"><a href="simple-web-scraping.html#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">&quot;Air Temperture (Kelvin)&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-13"><a href="simple-web-scraping.html#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;Month&quot;</span>,   <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>),</span>
<span id="cb53-14"><a href="simple-web-scraping.html#cb53-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>,<span class="st">&quot;May&quot;</span>,<span class="st">&quot;Jun&quot;</span>,<span class="st">&quot;Jul&quot;</span>,<span class="st">&quot;Aug&quot;</span>,<span class="st">&quot;Sep&quot;</span>,<span class="st">&quot;Oct&quot;</span>,<span class="st">&quot;Nov&quot;</span>,<span class="st">&quot;Dec&quot;</span>)) <span class="sc">+</span></span>
<span id="cb53-15"><a href="simple-web-scraping.html#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Fig 4: Line Chart Air Temperture by Month&quot;</span>, <span class="at">subtitle =</span> yearly) </span>
<span id="cb53-16"><a href="simple-web-scraping.html#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="simple-web-scraping.html#cb53-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-18"><a href="simple-web-scraping.html#cb53-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-19"><a href="simple-web-scraping.html#cb53-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.
## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-25-3.png" width="672" /></p>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-25-4.png" width="672" /></p>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-25-5.png" width="672" /><img src="_data-science-demo_files/figure-html/unnamed-chunk-25-6.png" width="672" /></p>
<p>Monthly average temperatures at the Snow Angel Study Plot are consistently warmer than the Senator Beck Study Plot. At no point from 2005 to 2010 was the Snow Angel Study Plot mean monthly temperature lower than the Senator Beck Study Plot.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="simple-web-scraping.html#cb59-1" aria-hidden="true" tabindex="-1"></a>q6_yearly_monthly <span class="ot">&lt;-</span> q4_full <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="simple-web-scraping.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,month,site) <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="simple-web-scraping.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_temp_k =</span> <span class="fu">mean</span>(air_temp_k,<span class="at">na.rm=</span>T))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="simple-web-scraping.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q6_yearly_monthly) <span class="sc">+</span> </span>
<span id="cb61-2"><a href="simple-web-scraping.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>month,<span class="at">y=</span>mean_temp_k,<span class="at">color=</span>year,<span class="at">group=</span><span class="fu">factor</span>(year)))<span class="sc">+</span>  </span>
<span id="cb61-3"><a href="simple-web-scraping.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site)<span class="sc">+</span></span>
<span id="cb61-4"><a href="simple-web-scraping.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">&quot;Air Temperture (Kelvin)&quot;</span>) <span class="sc">+</span></span>
<span id="cb61-5"><a href="simple-web-scraping.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;Month&quot;</span>,   <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>),</span>
<span id="cb61-6"><a href="simple-web-scraping.html#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>,<span class="st">&quot;May&quot;</span>,<span class="st">&quot;Jun&quot;</span>,<span class="st">&quot;Jul&quot;</span>,<span class="st">&quot;Aug&quot;</span>,<span class="st">&quot;Sep&quot;</span>,<span class="st">&quot;Oct&quot;</span>,<span class="st">&quot;Nov&quot;</span>,<span class="st">&quot;Dec&quot;</span>)) <span class="sc">+</span></span>
<span id="cb61-7"><a href="simple-web-scraping.html#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fig 5: Line Chart Air Temperture by Month&quot;</span>)</span></code></pre></div>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="simple-web-scraping.html#cb62-1" aria-hidden="true" tabindex="-1"></a>q6_monthly <span class="ot">&lt;-</span> q4_full <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="simple-web-scraping.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month,site) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="simple-web-scraping.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_temp_k =</span> <span class="fu">mean</span>(air_temp_k,<span class="at">na.rm=</span>T))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="simple-web-scraping.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q6_monthly) <span class="sc">+</span> </span>
<span id="cb64-2"><a href="simple-web-scraping.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>month,<span class="at">y=</span>mean_temp_k,<span class="at">color=</span>site)) <span class="sc">+</span> </span>
<span id="cb64-3"><a href="simple-web-scraping.html#cb64-3" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span> </span>
<span id="cb64-4"><a href="simple-web-scraping.html#cb64-4" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_few</span>() <span class="sc">+</span></span>
<span id="cb64-5"><a href="simple-web-scraping.html#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">&quot;Air Temperture (Kelvin)&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-6"><a href="simple-web-scraping.html#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;Month&quot;</span>,   <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>),</span>
<span id="cb64-7"><a href="simple-web-scraping.html#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>,<span class="st">&quot;May&quot;</span>,<span class="st">&quot;Jun&quot;</span>,<span class="st">&quot;Jul&quot;</span>,<span class="st">&quot;Aug&quot;</span>,<span class="st">&quot;Sep&quot;</span>,<span class="st">&quot;Oct&quot;</span>,<span class="st">&quot;Nov&quot;</span>,<span class="st">&quot;Dec&quot;</span>)) <span class="sc">+</span></span>
<span id="cb64-8"><a href="simple-web-scraping.html#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fig 6: Line Chart Air Temperture by Month&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;(All Years)&quot;</span>)</span></code></pre></div>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="bonus-1" class="section level3 hasAnchor" number="4.4.7">
<h3><span class="header-section-number">4.4.7</span> 7 Bonus #1<a href="simple-web-scraping.html#bonus-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Make a plot of average daily precipitation by day of year (averaged across all available years). Color each site.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="simple-web-scraping.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get daily precipitation by sum</span></span>
<span id="cb65-2"><a href="simple-web-scraping.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># average the days</span></span>
<span id="cb65-3"><a href="simple-web-scraping.html#cb65-3" aria-hidden="true" tabindex="-1"></a>q7_daily <span class="ot">&lt;-</span> q4_full <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="simple-web-scraping.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,month,day,site) <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="simple-web-scraping.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">daily_precip =</span> <span class="fu">sum</span>(precip..kg.m.<span class="fl">2.</span>s.<span class="fl">1.</span>), ) <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="simple-web-scraping.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month,day,site) <span class="sc">%&gt;%</span>  </span>
<span id="cb65-7"><a href="simple-web-scraping.html#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_precip =</span> <span class="fu">mean</span>(daily_precip), <span class="at">date =</span> <span class="fu">make_date</span>(<span class="st">&#39;1970&#39;</span>, month, day))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;, &#39;day&#39;. You can override
## using the `.groups` argument.
## `summarise()` has grouped output by &#39;month&#39;, &#39;day&#39;, &#39;site&#39;. You can override
## using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="simple-web-scraping.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q7_daily) <span class="sc">+</span> </span>
<span id="cb67-2"><a href="simple-web-scraping.html#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>mean_precip,<span class="at">color=</span>site)) <span class="sc">+</span> </span>
<span id="cb67-3"><a href="simple-web-scraping.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span> </span>
<span id="cb67-4"><a href="simple-web-scraping.html#cb67-4" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_few</span>() <span class="sc">+</span></span>
<span id="cb67-5"><a href="simple-web-scraping.html#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">&quot;Percip&quot;</span>) <span class="sc">+</span></span>
<span id="cb67-6"><a href="simple-web-scraping.html#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fig 7: Average daily percipitation&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;(All Years)&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>The number of years is not great enough to handle daily precipitation well. Trying monthly.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="simple-web-scraping.html#cb69-1" aria-hidden="true" tabindex="-1"></a>q7_daily <span class="ot">&lt;-</span> q4_full <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="simple-web-scraping.html#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,month,day,site) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="simple-web-scraping.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">daily_precip =</span> <span class="fu">sum</span>(precip..kg.m.<span class="fl">2.</span>s.<span class="fl">1.</span>) ) <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="simple-web-scraping.html#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month,site) <span class="sc">%&gt;%</span>  </span>
<span id="cb69-5"><a href="simple-web-scraping.html#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_precip =</span> <span class="fu">mean</span>(daily_precip))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;, &#39;day&#39;. You can override
## using the `.groups` argument.
## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="simple-web-scraping.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q7_daily) <span class="sc">+</span> </span>
<span id="cb71-2"><a href="simple-web-scraping.html#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>month,<span class="at">y=</span>mean_precip,<span class="at">color=</span>site)) <span class="sc">+</span> </span>
<span id="cb71-3"><a href="simple-web-scraping.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span> </span>
<span id="cb71-4"><a href="simple-web-scraping.html#cb71-4" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_few</span>() <span class="sc">+</span></span>
<span id="cb71-5"><a href="simple-web-scraping.html#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">&quot;Percip&quot;</span>) <span class="sc">+</span></span>
<span id="cb71-6"><a href="simple-web-scraping.html#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;Month&quot;</span>,   <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>),</span>
<span id="cb71-7"><a href="simple-web-scraping.html#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>,<span class="st">&quot;May&quot;</span>,<span class="st">&quot;Jun&quot;</span>,<span class="st">&quot;Jul&quot;</span>,<span class="st">&quot;Aug&quot;</span>,<span class="st">&quot;Sep&quot;</span>,<span class="st">&quot;Oct&quot;</span>,<span class="st">&quot;Nov&quot;</span>,<span class="st">&quot;Dec&quot;</span>)) <span class="sc">+</span></span>
<span id="cb71-8"><a href="simple-web-scraping.html#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fig 8: Average daily percipitation in a given month&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;(All Years)&quot;</span>)</span></code></pre></div>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>That was not helpful for finding a pattern. Also note: the daily precipitation is identical at both sites.</p>
</div>
<div id="bonus-2" class="section level3 hasAnchor" number="4.4.8">
<h3><span class="header-section-number">4.4.8</span> 8. Bonus #2<a href="simple-web-scraping.html#bonus-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use a function and for loop to create yearly plots of precipitation by day of year. Color each site.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="simple-web-scraping.html#cb72-1" aria-hidden="true" tabindex="-1"></a>q8_yearly_monthly <span class="ot">&lt;-</span> q4_full <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="simple-web-scraping.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,month,site) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="simple-web-scraping.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_temp_k =</span> <span class="fu">mean</span>(precip..kg.m.<span class="fl">2.</span>s.<span class="fl">1.</span>))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="simple-web-scraping.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q8_yearly_monthly) <span class="sc">+</span> </span>
<span id="cb74-2"><a href="simple-web-scraping.html#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>month,<span class="at">y=</span>mean_temp_k,<span class="at">color=</span>year,<span class="at">group=</span><span class="fu">factor</span>(year)))<span class="sc">+</span>  </span>
<span id="cb74-3"><a href="simple-web-scraping.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site)<span class="sc">+</span></span>
<span id="cb74-4"><a href="simple-web-scraping.html#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">&quot;Percip&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="simple-web-scraping.html#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&quot;Month&quot;</span>,   <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>),</span>
<span id="cb74-6"><a href="simple-web-scraping.html#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>,<span class="st">&quot;May&quot;</span>,<span class="st">&quot;Jun&quot;</span>,<span class="st">&quot;Jul&quot;</span>,<span class="st">&quot;Aug&quot;</span>,<span class="st">&quot;Sep&quot;</span>,<span class="st">&quot;Oct&quot;</span>,<span class="st">&quot;Nov&quot;</span>,<span class="st">&quot;Dec&quot;</span>)) <span class="sc">+</span></span>
<span id="cb74-7"><a href="simple-web-scraping.html#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fig 9: Line Chart Precipitation by Month&quot;</span>)</span></code></pre></div>
<p><img src="_data-science-demo_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
</div>
<div id="to-git-hub" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> To Git Hub<a href="simple-web-scraping.html#to-git-hub" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://github.com/BBudnicki/3_snow_functions_iteration">https://github.com/BBudnicki/3_snow_functions_iteration</a></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="simple-web-scraping.html#cb75-1" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">yday</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2022-02-01&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 32</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hayman-fire.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lagos-spatial-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/3-hw-snow.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_data-science-demo.pdf", "_data-science-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
